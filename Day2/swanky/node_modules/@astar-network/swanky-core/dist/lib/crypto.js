"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.decrypt = exports.encrypt = void 0;
const tslib_1 = require("tslib");
const node_crypto_1 = tslib_1.__importDefault(require("node:crypto"));
const ALGO = "aes-256-cbc";
function encrypt(text, password) {
    const iv = node_crypto_1.default.randomBytes(16);
    const key = node_crypto_1.default.scryptSync(password, "swankySalt", 32);
    const cipher = node_crypto_1.default.createCipheriv(ALGO, Buffer.from(key), iv);
    const encrypted = Buffer.concat([cipher.update(text), cipher.final()]);
    return { iv: iv.toString("hex"), data: encrypted.toString("hex") };
}
exports.encrypt = encrypt;
function decrypt(encrypted, password) {
    const iv = Buffer.from(encrypted.iv, "hex");
    const key = node_crypto_1.default.scryptSync(password, "swankySalt", 32);
    const encryptedText = Buffer.from(encrypted.data, "hex");
    const decipher = node_crypto_1.default.createDecipheriv(ALGO, Buffer.from(key), iv);
    const decrypted = Buffer.concat([decipher.update(encryptedText), decipher.final()]);
    return decrypted.toString();
}
exports.decrypt = decrypt;
